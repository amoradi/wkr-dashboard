function initDashboard(e){window.ReportIncompleteCount=0,fetchWeeklyReportsData(e.spreadsheetData)}function fetchWeeklyReportsData(e){axios.get(e).then(function(e){parseTeamMemberScores(e.data)}).catch(function(e){console.log(e)})}function parseTeamMemberScores(e){e.feed.entry.forEach(function(e){var a=e.content.$t,t=e.title.$t,r=toJson(a),o=r.headshot;return isReportIncomplete(a)?(ReportIncompleteCount++,1==ReportIncompleteCount&&(window.NoScoresMembers=createNoScoresSection()),drawTeamMember(t,o,!0),!0):(drawTeamMember(t,o),void createTeamMemberCharts(r,dashboardOpts.dashboardDimensions))}),ReportIncompleteCount&&(appendNode(NoScores,NoScoresMembers),appendNode(document.querySelector("."+dashboardOpts.mainClassName),NoScores))}function createNoScoresSection(){return window.NoScores=document.createElement("section"),h2=document.createElement("h2"),row=document.createElement("div"),NoScores.className=dashboardOpts.noScoresClassName,h2.className=dashboardOpts.headingClassName,h2.innerHTML=dashboardOpts.noScoresHeadingText,NoScores.appendChild(h2),row.className=dashboardOpts.rowClass+" "+dashboardOpts.rowClassWrap,row}function isReportIncomplete(e){var a=/: x/g;return a.test(e)}function drawTeamMember(e,a,t){var r=document.createElement("div"),o=document.createElement("span"),s=document.createElement("span");r.className=dashboardOpts.chartOpts.cellClassName,o.className=dashboardOpts.headShotClassName,o.style.backgroundImage="url("+a+")",t&&(o.style.borderColor=dashboardOpts.chartOpts.colors.activeColors[0].value),s.className=dashboardOpts.nameClassName,s.innerHTML=e,r.appendChild(o),r.appendChild(s);var n=t?window.NoScoresMembers:dashboardOpts.docFrag;appendNode(n,r)}function toJson(e){var a=e.split(","),t={};return a.forEach(function(e){e=e.split(": "),t[e[0].trim()]=e[1]}),t}function createTeamMemberCharts(e,a){a.forEach(function(a){var t=[parseInt(e[a[0]],10),parseInt(e[a[1]],10)];filterInvalidMemberFields(t)}),drawTeamMemberScores(dashboardOpts.docFrag,dashboardOpts.scoresContainerClassName)}function filterInvalidMemberFields(e){Number.isInteger(e[0])&&Number.isInteger(e[1])&&appendNode(dashboardOpts.docFrag,doughnutChartFactory(e,calculateColor(e)))}function calculateColor(e){var a=[dashboardOpts.chartOpts.colors.inverseColor];return dashboardOpts.chartOpts.colors.activeColors.some(function(t){var r=t.condition(e[1]);if(r)return a.push(t.value),!0}),a}function doughnutChartFactory(e,a){var t=document.createElement("canvas"),r=t.getContext("2d"),o=document.createElement("div");return new Chart(r,{type:"doughnut",data:{datasets:[{data:e,backgroundColor:a}]},options:{tooltips:{enabled:!1},responsive:!1,animation:{animateRotate:!0,animateScale:!0},cutoutPercentage:70,maintainAspectRatio:!1}}),t.setAttribute("data-score",e[1]),t.style.width=dashboardOpts.chartOpts.height,t.style.height=dashboardOpts.chartOpts.width,t.className=dashboardOpts.chartOpts.chartClassName,o.className=dashboardOpts.chartOpts.cellClassName,o.appendChild(t),o}function appendNode(e,a){e.appendChild(a)}function drawTeamMemberScores(e,a){var t=document.createElement("div");setMemberAvgScore(e),t.className=dashboardOpts.rowClass,t.appendChild(e),document.querySelector("."+a).appendChild(t)}function setMemberAvgScore(e){var a=calcTeamMemberAvgScore(e),t="."+dashboardOpts.headShotClassName,r=document.createElement("span"),o=calculateColor([0,a])[1];r.style.color=o,r.innerHTML="<br />"+a,e.querySelector(t).style.borderColor=o,e.querySelector(t+" + span").appendChild(r)}function calcTeamMemberAvgScore(e){var a=e.querySelectorAll("[data-score]"),t=a.length,r=0;for(i=0;i<t;i++)r+=parseInt(a[i].getAttribute("data-score"),10);return parseInt(r/t,10)}var dashboardOpts={spreadsheetData:"https://spreadsheets.google.com/feeds/list/1HRQm4opZYzyF8zzJiZOFZCQKcTas5Fw6CU8twSsy-3k/3/public/basic?alt=json",docFrag:document.createDocumentFragment(),dashboardDimensions:[["satisfactioninverse","satisfaction"],["workloadinverse","workload"],["prodinverse","productivity"],["clarityinverse","clarity"],["stressinverse","stresslevel"]],mainClassName:"TeamMemberScores-colMain",scoresContainerClassName:"TeamMemberScores-scores",headingClassName:"TeamMemberScores-heading",rowClass:"TeamMemberScores-row",rowClassWrap:"TeamMemberScores-rowWrap",headShotClassName:"TeamMemberScores-headShot",nameClassName:"u-small-label TeamMemberScores-name",noScoresClassName:"TeamMemberScores-noScores",noScoresHeadingText:"Didn't Fill Out Survey",chartOpts:{height:"75px",width:"75px",cellClassName:"TeamMemberScores-cell",chartClassName:"TeamMemberScores-chart",colors:{inverseColor:"#d3d3d3",activeColors:[{value:"#c26263",condition:function(e){return e<=35}},{value:"#e3e448",condition:function(e){return e>36&&e<=50}},{value:"#61c275",condition:function(e){return e>50}}]}}};initDashboard(dashboardOpts),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};